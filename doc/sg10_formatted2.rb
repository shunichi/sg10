# 外側のeval除去したことで、少しオリジナルと違いますが読みやすくしています
# * 普通の ruby のシンタックスハイライトがきく
# * コメントをつけられる

# 次に表示するAA形状データのインデックス
t=1;

# 最初のevalなしで実行するには $s への代入が別途必要
$s=%q{F=%q{^eE@K#[Wl.=Y@J6:cA[RThqqn^Y2GvcUd_x?VS+`#JaQd?^xC*`1$$QF6W]c)8r9P^8.]=Fx2rw%OH,vJ]koC:3)UHm+$M1P-jYdTVYh9bF[:BD>3$AS5g?5vbaFZszv5f'Yf1O.`/@P[ve"Vi4bE`]F"jQ(x[X#h:BM-Sc9$b!/27K4M,Nb<QX/STaH[R"m<GLvVC)oZm9Z(FDC2)FmJ;lQ)h>i.iSZLmS"7xDX5%w/tUT!1t8%c)-c'LjW*^2F=3j:SF;Q0Hb*GU<21=B<taC$9hcU%aeD!Olj*L6.Uq`f>^d.xUe1],4rst:tC0+lk$gL6KA6J#5ATs2eh=zz9X/r?Wvmrv>&cK"QpGtF(po-x9N$omsRI@hR$bsfJh9&+7:ROV[p"nIdI1REbvVey8YE)@b#M*&Nc4vxlNDizuyd5F6NVt:GXnENMImx4:x-aA6MD[nM/$ydX4+^T5=Lc"HY-;v$th:XT9Dg&spT%b"H0K:iI>EcV9;ZRoyiHI,I`'G(bmD*9:l1nag?mQ>)D_:@35.ladxoAn>2`aJYFsAotip+8b)>PbG7E1]Nj[J5^-?R0y4UTN(w=uvb;txWjVyK;1!A*,GI7:1r4=M-Ur%Gh1Wu?1SG'&H!FbI,I`/k5Hg=lZWoLgP^w(6Q-p>%:3q2]%#n%:S]SKzg:jZ1%eL@H]A!eV3y],wH)m.HYRlVu*#uUon-f&.XMo`28Ba?^Y+k8sg'/CNIzBmm")p98Xwz2CN^nrQjHI;(6Wf+(Jr8><t`O8[+D[nWg%M>-H>s,w(z2zCbFpsocn=sVuS8A=`txeOyGQIc7Ai783;7p0C/vB#[+9*wqq1z[dI=GDp.Z#rycD8_J0Gwl%5qT4Dm>3G$7jms<fE8q#Anb!F)a`h};M=%q{a%:qav$F#5'sYK85^(&qpdUobG6ljge=5y>dBq'!A*cv1;lFep=qV/HD*l-",;.5K;n1!cM(%:B&3]<pqseUrJ&u0NTux;:I<xT*uRAqA'$YvaTcj^ZeySBm$5R2`^r_P&SL_V.PL,o[v#/!*fD^Yoa&@%G9IB(ruRm59lHa>M[[]f45v3J',"7W='*N3n<>@W7G(TEntN&*n+v?K'D6HcU5hf>@ln6/P@[,Q/Wf]6DDBYtsYTv)w-*@a:,%.C-7)$%*W0kz"[ecBoD-Ms`h%YP_3@RN)cH^7*5R+w8*^Cz_CM;?vr'WJipcz@u_>8b$A/:v2jJkH5"iz)riY!V$o?B>,HiH4)bC:7[G7/pTe^Y+R8+dNaROd0uY:iN['BP&Q$W1Bx[U'b0?O2e1U<sptLj@(_0n%bn%vc[h_llU&Z"6:pXjh<12n2+nT['h`:z]8B;uu,l=E>SbA>K'^@1e;<.Q^a(BpbaUZ-nUXuwA;8Ff%>jl<a19gGp#hipSZB;5WqAf"4-aDB?0c<Ml#l8frO4,V3HfEv(dDTSt)1U$=H$gdz,$@;#dIg1-m#Zn:!1Fl-8yM5G]6tGUk[EV>@FII905b<,qXS7"l[N9ROZV2MkTJ#k2Rw./B]a<E=FZR!GU5D([F;e>r_"hN$n19++ToinmDg<N@'_93'3s(r"<L.LN0+tb:5oDR+Zl"XZwsZbJTTIIoB&zjXEGmP]I^Gh'fBDVb+kX@58(K7#(,/.@,g`Q8Qk64At"JRJT5w)K??rwrk%K_qSip:$T;YL!T7Jw"Ia5tHTVb)YlRA^&Bt`8fSF"^mdy<d&p=CN:<u#-`wCOiX[csKeRi@>wvrpJOL6,Q4N%Vz(7RU:MK$[$8OIQQMw[H+kC@E:<XQ;B"7vP8MSKStCYe^+@#!44FF@!O7pakdcoup>`TbBYS0%,;@7'PA6lc(dV>&SQB*vq1l/eF;(W'KhM*wYPyFg>uly"`QKOP/'.N$GsVHcS"eawc[$bhPN*f%C")[g/*[Hz%,p`ZV9k"Hk%/xnD/^_o>lZvg_Dlw8iIMf7vrVRwt2^@M`O5NMOSsg;puV^e=-Vu;kAE3y^"tL`)s5n>4(Q-MB=K?a(8?:JIJv-K(G>ywW;wpO&0B5pIaN57E?)FLC@y#W+norP6tod6qC)?ZToI;4/7MU1rV6glsW4LRd`C`%hX=lV!MoW&$bW:n4H<qoH14vh<B.z9SOhAao++zEU7/Bj>z9ef[L)M]vGNyeFO"]$(Y(Su<'IML6`)u#ImT+jIE(!5fqsk9RAo:d:z;yGCG6=-9aU$nhU>_Q15qS#&E3snf9Zoqn_&Y>TaDc6JQ4IT6"=+YzIZk;QpxV?Q)0z'ik(hQ"5!ne`*>V]L4O:qi^[jkMn4@qQ0IZD(ffe+S&pfOT&^u]X-da'/oc+$&OKb.&8=%nl/Bc&Rt:;pkd,vF+V21R7x-gp:9"x4bM<xem-9u9ebk-Xe:mWoY>"wUC3)?h`<gG_kmcucJ+MKav<JPb7&E+][Rc`q53.B>w@Yaz3d9FgtDn4Xg66?p3sp$mUCL3cvl1B$TT%j?gg=4*Em]w+6@LO]Il$cui#2WMZNW!+n9ozCq[tyt@N>q<Ksj0^"P$fi1$4tdy@X-OC8373WNz5K[-4.Ab*yg9p:=$@?=@V^*j:)Z%zrsSdf]NOe]j5gY<)lbrOjY_:&/t#6yi%j$7(ogKjLa]!hBo#[gWgUn"NWpNs!0bN$:`BCM'AI8Slg0g@j$t+i:0T5tCT1`5a8dQSPM=XrU+(+JMA[ARofi72I4U;XSLbqXi8]!U`#:3*Pi'kvQ,?(=!Umg.JXRA)-"xNux%bSN`;]MXvZRvLUs4g$AgHM"#aCBUu>:fzj1RVen@c#Re:RE7-5tJTyS&uF;wk##kXgZM/3W3xcPRWcn!mhSL+:t']V^O3<6*"a8+4Exp[OyPz'*yrgvjO>)p)k7h:u*uCrP[AgL0>(RumFK^!a/rFZVvyeozsWWj]dK5MRlJ+o@pu(@co$=u;jbWaa#XxNMCeO3MZj$rk5*lwR8Eyb'<hQQF3IsX/^x>M^>NJ)%-Exl4dgLhRK.+C01&N$XIYq-`oJ.4p%Zh=j+q`rTEM??f6iic-pX4&q]SI=Ws<8(ejF&cayNgebZ&`w,5sg$=C5V*#)RzsDSsta/Yv*<IiaPO^-J)*j->yWqCXYbuH/7,ZJN6^J1'XHF>Hu-&F^dv!&t@2$P6kKJ3y_&rstx_[UQ[B*Md#gWh:UD3,=sVu`As.Qg*qCuJJepSY^XP(HOo%hY'fDb9GLgW/dvpDzAfgO,E%oME)-uFHWm4F7]$2>.kC.rOZ3u6J84p&,slUB6-mkFz!rFRW*)_("5nc1!s)=z,tt06;dIrABde@jO]+6`0m+O3=h&KapQ]lX9>"Pv?&!=-vKRXUS(ivh$NwOoR+sQ2_aq?TXOyTQbDM/]3LT<+tHKRW=VkN'AX1M`=>>*OFbril-]$`ki5BnHu0&0O?6A&Qw)!wi.vZ[5@QAm[owN(p8&:2e).9/!K7%Dcw!ew.-c>q^?)hanxVn#"LHHLaf<Zwc(+cE`,p;t+4qbn13C4ADf49v(a%>7HF,y4<g]<>#zn>j:lmilDYe'AP"gXiS`U/v]^4Y$,$VD>FX8=a>y!4CUlD39qNMMXt%4*8"V;!7Zrg;-P.'"hK!6E'#`vD$c5j9-yjpgA]PN?EV<fD0lMwVKE42)m8S&CW)KooAbGfP>C](S3t3X3wQwQpRr4runR@e$W>hY0dzoK].:IQfI&&jrhmX&'0ZuWKH!La-uO.n+_l^@Lvl+cQf^2sM0(8De7aU)*(UpRY=Wx+ITy,?am^f]-"UeTx`:p4"4:KYEVLLUn)h-xPU+T6q__)2Hh_nv),JS"RJ'Hxy.##q4Jnl/q#86hy0th$[v!,pA.mG1J)]lD-bVgpP5%VJpN)r(!ilog=GNAlp9QSJw37gW30-s+;%#po};require'zlib';D=->(a,h){f=0;a.unpack("C*").map{|c|f=f*89+((c-2)%90-1)};Zlib::Inflate.inflate(Marshal.dump(f)[h..-1]);;};f=D[F,7];if(ARGV.first=='music');eval(D[M,7]);exit;end;S=%{t=#{(t+1)%4};eval$s=%w{#$s}*"";%|}+F*30;48.times{|n|puts(("%032b%032b%032b%032b"%(f[t*768+16*n,16].unpack("N4"))).gsub(/./){$&<"1"?(32.chr):S.slice!(0,1)})};print(S.slice!(0,100)+'+'+'-'*27+10.chr+S.slice!(0,100));puts("|"+%(,#,Sonic,Garden,10th,Anniv.).split(',').join(32.chr));}

# zlib圧縮＆ASCIIエンコードされたAA形状データ
F=%q{^eE@K#[Wl.=Y@J6:cA[RThqqn^Y2GvcUd_x?VS+`#JaQd?^xC*`1$$QF6W]c)8r9P^8.]=Fx2rw%OH,vJ]koC:3)UHm+$M1P-jYdTVYh9bF[:BD>3$AS5g?5vbaFZszv5f'Yf1O.`/@P[ve"Vi4bE`]F"jQ(x[X#h:BM-Sc9$b!/27K4M,Nb<QX/STaH[R"m<GLvVC)oZm9Z(FDC2)FmJ;lQ)h>i.iSZLmS"7xDX5%w/tUT!1t8%c)-c'LjW*^2F=3j:SF;Q0Hb*GU<21=B<taC$9hcU%aeD!Olj*L6.Uq`f>^d.xUe1],4rst:tC0+lk$gL6KA6J#5ATs2eh=zz9X/r?Wvmrv>&cK"QpGtF(po-x9N$omsRI@hR$bsfJh9&+7:ROV[p"nIdI1REbvVey8YE)@b#M*&Nc4vxlNDizuyd5F6NVt:GXnENMImx4:x-aA6MD[nM/$ydX4+^T5=Lc"HY-;v$th:XT9Dg&spT%b"H0K:iI>EcV9;ZRoyiHI,I`'G(bmD*9:l1nag?mQ>)D_:@35.ladxoAn>2`aJYFsAotip+8b)>PbG7E1]Nj[J5^-?R0y4UTN(w=uvb;txWjVyK;1!A*,GI7:1r4=M-Ur%Gh1Wu?1SG'&H!FbI,I`/k5Hg=lZWoLgP^w(6Q-p>%:3q2]%#n%:S]SKzg:jZ1%eL@H]A!eV3y],wH)m.HYRlVu*#uUon-f&.XMo`28Ba?^Y+k8sg'/CNIzBmm")p98Xwz2CN^nrQjHI;(6Wf+(Jr8><t`O8[+D[nWg%M>-H>s,w(z2zCbFpsocn=sVuS8A=`txeOyGQIc7Ai783;7p0C/vB#[+9*wqq1z[dI=GDp.Z#rycD8_J0Gwl%5qT4Dm>3G$7jms<fE8q#Anb!F)a`h}

# zlib圧縮＆ASCIIエンコードされた音楽再生プログラム
M=%q{a%:qav$F#5'sYK85^(&qpdUobG6ljge=5y>dBq'!A*cv1;lFep=qV/HD*l-",;.5K;n1!cM(%:B&3]<pqseUrJ&u0NTux;:I<xT*uRAqA'$YvaTcj^ZeySBm$5R2`^r_P&SL_V.PL,o[v#/!*fD^Yoa&@%G9IB(ruRm59lHa>M[[]f45v3J',"7W='*N3n<>@W7G(TEntN&*n+v?K'D6HcU5hf>@ln6/P@[,Q/Wf]6DDBYtsYTv)w-*@a:,%.C-7)$%*W0kz"[ecBoD-Ms`h%YP_3@RN)cH^7*5R+w8*^Cz_CM;?vr'WJipcz@u_>8b$A/:v2jJkH5"iz)riY!V$o?B>,HiH4)bC:7[G7/pTe^Y+R8+dNaROd0uY:iN['BP&Q$W1Bx[U'b0?O2e1U<sptLj@(_0n%bn%vc[h_llU&Z"6:pXjh<12n2+nT['h`:z]8B;uu,l=E>SbA>K'^@1e;<.Q^a(BpbaUZ-nUXuwA;8Ff%>jl<a19gGp#hipSZB;5WqAf"4-aDB?0c<Ml#l8frO4,V3HfEv(dDTSt)1U$=H$gdz,$@;#dIg1-m#Zn:!1Fl-8yM5G]6tGUk[EV>@FII905b<,qXS7"l[N9ROZV2MkTJ#k2Rw./B]a<E=FZR!GU5D([F;e>r_"hN$n19++ToinmDg<N@'_93'3s(r"<L.LN0+tb:5oDR+Zl"XZwsZbJTTIIoB&zjXEGmP]I^Gh'fBDVb+kX@58(K7#(,/.@,g`Q8Qk64At"JRJT5w)K??rwrk%K_qSip:$T;YL!T7Jw"Ia5tHTVb)YlRA^&Bt`8fSF"^mdy<d&p=CN:<u#-`wCOiX[csKeRi@>wvrpJOL6,Q4N%Vz(7RU:MK$[$8OIQQMw[H+kC@E:<XQ;B"7vP8MSKStCYe^+@#!44FF@!O7pakdcoup>`TbBYS0%,;@7'PA6lc(dV>&SQB*vq1l/eF;(W'KhM*wYPyFg>uly"`QKOP/'.N$GsVHcS"eawc[$bhPN*f%C")[g/*[Hz%,p`ZV9k"Hk%/xnD/^_o>lZvg_Dlw8iIMf7vrVRwt2^@M`O5NMOSsg;puV^e=-Vu;kAE3y^"tL`)s5n>4(Q-MB=K?a(8?:JIJv-K(G>ywW;wpO&0B5pIaN57E?)FLC@y#W+norP6tod6qC)?ZToI;4/7MU1rV6glsW4LRd`C`%hX=lV!MoW&$bW:n4H<qoH14vh<B.z9SOhAao++zEU7/Bj>z9ef[L)M]vGNyeFO"]$(Y(Su<'IML6`)u#ImT+jIE(!5fqsk9RAo:d:z;yGCG6=-9aU$nhU>_Q15qS#&E3snf9Zoqn_&Y>TaDc6JQ4IT6"=+YzIZk;QpxV?Q)0z'ik(hQ"5!ne`*>V]L4O:qi^[jkMn4@qQ0IZD(ffe+S&pfOT&^u]X-da'/oc+$&OKb.&8=%nl/Bc&Rt:;pkd,vF+V21R7x-gp:9"x4bM<xem-9u9ebk-Xe:mWoY>"wUC3)?h`<gG_kmcucJ+MKav<JPb7&E+][Rc`q53.B>w@Yaz3d9FgtDn4Xg66?p3sp$mUCL3cvl1B$TT%j?gg=4*Em]w+6@LO]Il$cui#2WMZNW!+n9ozCq[tyt@N>q<Ksj0^"P$fi1$4tdy@X-OC8373WNz5K[-4.Ab*yg9p:=$@?=@V^*j:)Z%zrsSdf]NOe]j5gY<)lbrOjY_:&/t#6yi%j$7(ogKjLa]!hBo#[gWgUn"NWpNs!0bN$:`BCM'AI8Slg0g@j$t+i:0T5tCT1`5a8dQSPM=XrU+(+JMA[ARofi72I4U;XSLbqXi8]!U`#:3*Pi'kvQ,?(=!Umg.JXRA)-"xNux%bSN`;]MXvZRvLUs4g$AgHM"#aCBUu>:fzj1RVen@c#Re:RE7-5tJTyS&uF;wk##kXgZM/3W3xcPRWcn!mhSL+:t']V^O3<6*"a8+4Exp[OyPz'*yrgvjO>)p)k7h:u*uCrP[AgL0>(RumFK^!a/rFZVvyeozsWWj]dK5MRlJ+o@pu(@co$=u;jbWaa#XxNMCeO3MZj$rk5*lwR8Eyb'<hQQF3IsX/^x>M^>NJ)%-Exl4dgLhRK.+C01&N$XIYq-`oJ.4p%Zh=j+q`rTEM??f6iic-pX4&q]SI=Ws<8(ejF&cayNgebZ&`w,5sg$=C5V*#)RzsDSsta/Yv*<IiaPO^-J)*j->yWqCXYbuH/7,ZJN6^J1'XHF>Hu-&F^dv!&t@2$P6kKJ3y_&rstx_[UQ[B*Md#gWh:UD3,=sVu`As.Qg*qCuJJepSY^XP(HOo%hY'fDb9GLgW/dvpDzAfgO,E%oME)-uFHWm4F7]$2>.kC.rOZ3u6J84p&,slUB6-mkFz!rFRW*)_("5nc1!s)=z,tt06;dIrABde@jO]+6`0m+O3=h&KapQ]lX9>"Pv?&!=-vKRXUS(ivh$NwOoR+sQ2_aq?TXOyTQbDM/]3LT<+tHKRW=VkN'AX1M`=>>*OFbril-]$`ki5BnHu0&0O?6A&Qw)!wi.vZ[5@QAm[owN(p8&:2e).9/!K7%Dcw!ew.-c>q^?)hanxVn#"LHHLaf<Zwc(+cE`,p;t+4qbn13C4ADf49v(a%>7HF,y4<g]<>#zn>j:lmilDYe'AP"gXiS`U/v]^4Y$,$VD>FX8=a>y!4CUlD39qNMMXt%4*8"V;!7Zrg;-P.'"hK!6E'#`vD$c5j9-yjpgA]PN?EV<fD0lMwVKE42)m8S&CW)KooAbGfP>C](S3t3X3wQwQpRr4runR@e$W>hY0dzoK].:IQfI&&jrhmX&'0ZuWKH!La-uO.n+_l^@Lvl+cQf^2sM0(8De7aU)*(UpRY=Wx+ITy,?am^f]-"UeTx`:p4"4:KYEVLLUn)h-xPU+T6q__)2Hh_nv),JS"RJ'Hxy.##q4Jnl/q#86hy0th$[v!,pA.mG1J)]lD-bVgpP5%VJpN)r(!ilog=GNAlp9QSJw37gW30-s+;%#po}

require'zlib';

# ASCIIデコード＆zlib展開
D=->(a,h){
  f=0;
  a.unpack("C*").map{|c|f=f*89+((c-2)%90-1)};
  Zlib::Inflate.inflate(Marshal.dump(f)[h..-1]);
  ;
};

# AA形状ビットマップデータ(1bitがAAの1文字)
f=D[F,7];

# 引数 music を与えられたときは音楽再生
if(ARGV.first=='music');
  eval(D[M,7]);
  exit;
end;

# S = 出力する文字列（AA成形前）
#
# t=#{(t+1)%4}
#   次のAAのインデックス
#
# eval$s=%w{#$s}*""
#   Quine基本形
#   #{$s} はより短く #$s にしている
#
# %|
#   パディング文字列の開始
#
# + F*30;
#   パディング文字列の内容(|を含まなくて十分な長さがあれば何でもいい)
S=%{t=#{(t+1)%4};eval$s=%w{#$s}*"";%|} + F*30;

# AA成形処理(48行分)
48.times { |n|
  puts(
    (
      # インデックスtのAAデータのn行目
      # f[t*768+16*n,16]
      #
      # 1行のサイズ(bytes)    16 = 128(AA横幅) / 8(bits/byte)
      # AA1個のサイズ(bytes) 768 = 16(1行サイズ) * 48(AA行数)
      #
      # 16bytesのデータを128文字の01に変換
      # "%032b%032b%032b%032b" % bytes.unpack("N4")
      "%032b%032b%032b%032b" % (f[t*768+16*n,16].unpack("N4"))
    ).gsub(/./){
      # $& は正規表現のマッチ文字列
      # 正規表現は /./ なので1文字ずつ切り出していることになる
      # 文字列が "1" ならスペース
      # 文字列が "0" ならSの先頭1文字を出力
      $& < "1" ? (32.chr) : S.slice!(0,1)
    }
  )
};

# 最後の2行の | の直前までを出力
print(
  S.slice!(0,100) + '+' + '-' * 27 + 10.chr + S.slice!(0,100)
);

# 最後の行の | 以降を出力
# | はパディング文字列を閉じる記号
puts( "|" + %(,#,Sonic,Garden,10th,Anniv.).split(',').join(32.chr));

# 以降はプログラムとしては意味はないパディング
# 文字列リテラル %|...| とコメントなので実行に影響は与えない
%|^eE@K#[Wl.=Y@J6:cA[RThqqn^Y2GvcUd_x?VS+`#JaQd?^xC*`1$$QF6W]c)8r9P^8.]=Fx2+---------------------------rw%OH,vJ]koC:3)UHm+$M1P-jYdTVYh9bF[:BD>3$AS5g?5vbaFZszv5f'Yf1O.`/@P[ve"Vi4bE`]F"jQ(x[X#h:BM-Sc9$b!/2|
# Sonic Garden 10th Anniv.
